#Drone CI File!
#Commit Message: Drone! Captain Canary is here! 

kind: pipeline
type: kubernetes
name: default

steps:
- name: build
  image: maven:3.6-openjdk-8-slim
  commands:
    - "mvn -Dskiptests clean install"
    #- "mvn -DskipTests=true -Dmaven.javadoc.skip=true -B -V"
  volumes:
    - name: m2
      path: /root/.m2
  
#- name: test
#  image: maven:3.6-openjdk-8
#  commands:
#    - "mvn test -B"
- name: Target
  image: busybox
  commands:
    - "ls -al target/"
    - "pwd"
    - "find / -iname repository"
    - "ls -al /drone"
    - "ls -al /root"
  depends_on:
  - build
 
volumes:
  - name: mypd
    persistentVolumeClaim:
      claimName: gocd-cicd-agent
